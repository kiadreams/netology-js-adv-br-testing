(()=>{"use strict";class t{static types={VISA:"visa",MASTERCARD:"mastercard",AMEX:"amex",DISCOVER:"discover",JCB:"jcb",DINERS:"diners",MIR:"mir"};#t;#e;#i;#s;#r;typePaymentSystem(t){return this.#a(t),this.#n}get#n(){return this.#d()?t.types.VISA:this.#u()?t.types.MASTERCARD:this.#c()?t.types.AMEX:this.#m()?t.types.DISCOVER:this.#h()?t.types.JCB:this.#o()?t.types.DINERS:this.#l()?t.types.MIR:void 0}#a(t){this.#t=Number(t.slice(0,1)),this.#e=Number(t.slice(0,2)),this.#i=Number(t.slice(0,3)),this.#s=Number(t.slice(0,4)),this.#r=Number(t.slice(0,4))}#d(){return 4===this.#t}#u(){return!!this.#b(51,55,this.#e)||this.#b(222100,272099,this.#r)}#c(){return[34,37].includes(this.#e)}#m(){return 65===this.#e||6011===this.#s||(!!this.#b(644,649,this.#i)||this.#b(622126,622925,this.#r))}#h(){for(let t=3528;t<3589;t++)if(t===this.#s)return!0;return!1}#o(){return!![36,54].includes(this.#e)||this.#b(300,305,this.#i)}#l(){return this.#b(2200,2204,this.#s)}#b(t,e,i){for(let s=t;s<e+1;s++)if(s===i)return!0;return!1}}class e{constructor(){this.cards=this.#p(),this.#f()}#f(){Object.values(t.types).forEach((t=>{this.cards.append(this.#g(t))}))}#p(){const t=document.createElement("ul");return t.classList.add("cards"),t}#g(t){const e=document.createElement("li"),i=document.createElement("span");return i.classList.add("card",t,"card-disabled"),i.textContent=t,i.setAttribute("title",t),e.append(i),e}showCardType(t){if(void 0!==t){this.cards.querySelector(`.${t}`).classList.remove("card-disabled")}}disableCards(){this.cards.querySelectorAll(".card").forEach((t=>{t.classList.add("card-disabled")}))}}class i{#y;#C;constructor(t){this.#y=t,this.#C="",this.paymentType=void 0}set number(t){this.#C=t,this.paymentType=this.#y.typePaymentSystem(t)}get number(){return this.#C}validateCardNumber(){if(this.number.length<12||void 0===this.paymentType)return!1;let t=0;const e=this.number.slice(0,-1),i=e.length%2;return[...e].forEach(((e,s)=>{const r=Number(e);t+=s%2===i?r:r>4?2*r-9:2*r})),(10-t%10)%10===Number(this.number[this.number.length-1])}}class s{constructor(){this.card=new i(new t),this.form=this.#N(),this.inputField=this.#D(),this.#O()}#O(){const t=this.#I();this.form.append(this.inputField,t)}#N(){const t=document.createElement("form");return t.id="form",t.noValidate="novalidate",t.classList.add("box-of-form"),t}#D(){const t=document.createElement("input");return t.id="card_number",t.type="text",t.name="card_number",t.placeholder="номер карты",t.classList.add("input-field"),t}#I(){const t=document.createElement("button");return t.id="submit-button",t.type="submit",t.textContent="Проверить номер карты",t.classList.add("submit-button"),t}setCardNumber(){const t=this.inputField.value;isNaN(t)?(alert("Номер карты должен состоять только из цифр"),this.inputField.value=this.card.number):this.card.number=t}get cardType(){return this.card.paymentType}validateCard(){return this.card.validateCardNumber()}}const r=document.querySelector("body");new class{constructor(t){this.cardList=new e,this.widgetForm=new s,this.#v(t),this.checkCardNumber=this.checkCardNumber.bind(this),this.checkTypeOfCard=this.checkTypeOfCard.bind(this),this.widgetForm.inputField.addEventListener("input",this.checkTypeOfCard),this.widgetForm.form.addEventListener("submit",this.checkCardNumber)}#v(t){const e=this.#E();e.append(this.cardList.cards),e.append(this.widgetForm.form),t.append(e)}#E(){const t=document.createElement("div");t.classList.add("validate-card-widget");const e=document.createElement("h3");return e.textContent="Проверка номера карты",t.append(e),t}checkCardNumber(t){t.preventDefault(),this.widgetForm.validateCard()?alert("Номер карты корректный!"):alert("Указан некоректный номер карты!")}checkTypeOfCard(t){t.preventDefault(),this._inputTimeout&&clearTimeout(this._inputTimeout),this._inputTimeout=setTimeout((()=>{this.cardList.disableCards(),this.widgetForm.setCardNumber(),this.widgetForm.card.number&&this.cardList.showCardType(this.widgetForm.cardType)}),200)}}(r)})();